<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="utf-8"/>
		<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
		<title>Administration - Assistant IA Local</title>
		<link href="styles/main.css" rel="stylesheet"/>
		<link href="styles/admin.css" rel="stylesheet"/>
		<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
		<link href="assets/icons/assistant-icon.png" rel="icon" type="image/png"/>
		<link href="styles/neon-light.css" rel="stylesheet"/>
	</head>
	<body class="light-theme">
		<div class="app-container admin-layout">
			<!-- Sidebar pour la navigation -->
			<aside class="sidebar">
				<div class="sidebar-header">
					<h1>Admin</h1>
					<a class="btn secondary" href="index.html">
					<i class="fas fa-arrow-left"></i> Retour √† l'Assistant
					</a>
				</div>
				<nav class="admin-nav">
					<ul>
						<li class="active" data-section="dashboard">
							<i class="fas fa-tachometer-alt"></i> Tableau de bord
						</li>
						<li data-section="models">
							<i class="fas fa-brain"></i> Mod√®les LLM
						</li>
						<li data-section="memory">
							<i class="fas fa-database"></i> M√©moire
						</li>
						<li data-section="voice">
							<i class="fas fa-microphone"></i> Syst√®me Vocal
						</li>
						<li data-section="config">
							<i class="fas fa-cogs"></i> Configuration
						</li>
						<li data-section="logs">
							<i class="fas fa-list"></i> Logs
						</li>
						<li data-section="lights">
							<i class="fas fa-lightbulb"></i> Lumi√®res
						</li>
					</ul>
				</nav>
			</aside>
			<!-- Contenu principal -->
			<main class="main-content">
				<header class="main-header">
					<div class="page-title">
						<h2 id="section-title">Tableau de bord</h2>
					</div>
					<div class="header-actions">
						<button class="btn secondary" id="refresh-btn">
						<i class="fas fa-sync-alt"></i> Actualiser
						</button>
					</div>
				</header>
				<div class="admin-content">
					<!-- Section Tableau de bord -->
					<section class="admin-section active" id="dashboard-section">
						<div class="status-cards">
							<div class="status-card" id="system-status-card">
								<div class="status-icon">
									<i class="fas fa-server"></i>
								</div>
								<div class="status-info">
									<h3>Statut Syst√®me</h3>
									<div class="status-indicator">
										<span class="status-dot"></span>
										<span class="status-text">Chargement...</span>
									</div>
								</div>
							</div>
							<div class="status-card" id="llm-status-card">
								<div class="status-icon">
									<i class="fas fa-brain"></i>
								</div>
								<div class="status-info">
									<h3>Mod√®les LLM</h3>
									<div class="status-indicator">
										<span class="status-dot"></span>
										<span class="status-text">Chargement...</span>
									</div>
								</div>
							</div>
							<div class="status-card" id="stt-status-card">
								<div class="status-icon">
									<i class="fas fa-headphones"></i>
								</div>
								<div class="status-info">
									<h3>Reconnaissance Vocale</h3>
									<div class="status-indicator">
										<span class="status-dot"></span>
										<span class="status-text">Chargement...</span>
									</div>
								</div>
							</div>
							<div class="status-card" id="tts-status-card">
								<div class="status-icon">
									<i class="fas fa-volume-up"></i>
								</div>
								<div class="status-info">
									<h3>Synth√®se Vocale</h3>
									<div class="status-indicator">
										<span class="status-dot"></span>
										<span class="status-text">Chargement...</span>
									</div>
								</div>
							</div>
						</div>
						<div class="resource-usage">
							<div class="resource-card">
								<h3>Utilisation CPU</h3>
								<div class="gauge-container">
									<div class="gauge" id="cpu-gauge">
										<div class="gauge-value"></div>
									</div>
									<div class="gauge-label">0%</div>
								</div>
							</div>
							<div class="resource-card">
								<h3>Utilisation M√©moire</h3>
								<div class="gauge-container">
									<div class="gauge" id="memory-gauge">
										<div class="gauge-value"></div>
									</div>
									<div class="gauge-label">0%</div>
								</div>
							</div>
							<div class="resource-card">
								<h3>Utilisation Disque</h3>
								<div class="gauge-container">
									<div class="gauge" id="disk-gauge">
										<div class="gauge-value"></div>
									</div>
									<div class="gauge-label">0%</div>
								</div>
							</div>
						</div>
						<div class="quick-actions">
							<h3>Actions rapides</h3>
							<div class="action-buttons">
								<button class="btn primary" id="restart-btn">
								<i class="fas fa-power-off"></i> Red√©marrer les services
								</button>
								<button class="btn secondary" id="compact-memory-btn">
								<i class="fas fa-compress-arrows-alt"></i> Compacter la m√©moire
								</button>
								<button class="btn secondary" id="test-voice-btn">
								<i class="fas fa-microphone"></i> Tester le syst√®me vocal
								</button>
							</div>
						</div>
					</section>
					<!-- Section Mod√®les LLM -->
					<!-- Section M√©moire -->
                    <section class="admin-section" id="memory-section">
                        <!-- DASHBOARD DES STATS DES MEMOIRES -->
                        <div class="memory-stats">
                            <div class="memory-stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-vector-square"></i>
                                </div>
                                <div class="stat-info">
                                    <h3>M√©moire Vectorielle</h3>
                                    <div class="stat-value" id="vector-memory-count">0</div>
                                    <div class="stat-label">vecteurs</div>
                                </div>
                            </div>
                            <div class="memory-stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-project-diagram"></i>
                                </div>
                                <div class="stat-info">
                                    <h3>M√©moire Symbolique</h3>
                                    <div class="stat-value" id="entity-count">0</div>
                                    <div class="stat-label">entit√©s</div>
                                </div>
                            </div>
                            <div class="memory-stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-brain"></i>
                                </div>
                                <div class="stat-info">
                                    <h3>Relations</h3>
                                    <div class="stat-value" id="relation-count">0</div>
                                    <div class="stat-label">connexions</div>
                                </div>
                            </div>
                            <div class="memory-stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-database"></i>
                                </div>
                                <div class="stat-info">
                                    <h3>Taille Totale</h3>
                                    <div class="stat-value" id="memory-size">0</div>
                                    <div class="stat-label">KB</div>
                                </div>
                            </div>
                        </div>
                        <!-- ‚úÖ SOUS-MENU M√âMOIRE -->
                        <div class="tab-header memory-submenu">
                            <div class="tab sub-active" data-memory-tab="synthetic">üìö Synth√©tique</div>
                            <div class="tab" data-memory-tab="symbolic">üß† Symbolique</div>
                            <div class="tab" data-memory-tab="vector">üß¨ Vecteurs</div>
                        </div>
                        <!-- ‚úÖ SYNTH√âTIQUE -->
                        <div class="tab-pane memory-tab-pane active" id="memory-synthetic-section">
                            <p class="empty-state">Synth√®se non encore g√©n√©r√©e</p>
                        </div>
                        <!-- ‚úÖ SYMBOLIQUE -->
                        <div class="tab-pane memory-tab-pane" id="memory-symbolic-section">

                            <div class="section-header with-actions">
                                <h3>Sujets de m√©moire</h3>
                                <button class="btn secondary" id="refresh-topics-btn">
                                <i class="fas fa-sync-alt"></i> Actualiser
                                </button>
                            </div>
                            <div class="memory-topics" id="memory-topics">
                                <div class="loading-indicator">
                                    <i class="fas fa-spinner fa-spin"></i> Chargement des sujets...
                                </div>
                            </div>
                            <div class="memory-actions">
                                <h3>Actions</h3>
                                <div class="action-buttons">
                                    <button class="btn secondary" id="view-memory-btn">
                                    <i class="fas fa-eye"></i> Visualiser les donn√©es
                                    </button>
                                    <button class="btn primary" id="compact-memory-action-btn">
                                    <i class="fas fa-compress-arrows-alt"></i> Compacter la m√©moire
                                    </button>
                                    <button class="btn secondary" id="backup-memory-btn">
                                    <i class="fas fa-download"></i> Sauvegarder</button>
                                </div>
                            </div>
                            <div class="section-header with-actions">
                                <h3>R√®gles du graphe symbolique</h3>
                                <button class="btn secondary" id="refresh-symbolic-rules-btn">
                                <i class="fas fa-sync-alt"></i> Actualiser
                                </button>
                            </div>
                            <!-- ‚úÖ Bouton attendu par injectIntoAdmin -->
                            <div style="display:none">
                                <button id="load-graph-btn"></button>
                            </div>
                            <div class="symbolic-rules-container" id="symbolic-rules-editor-container">
                                <div class="loading-indicator">
                                    <i class="fas fa-spinner fa-spin"></i> Chargement des r√®gles...
                                </div>
                            </div>
                        </div>
                        <!-- ‚úÖ VECTEURS -->
                        <div class="tab-pane memory-tab-pane" id="memory-vector-section">
                            <p class="empty-state">M√©moire vectorielle √† venir...</p>
                        </div>
                    </section>

  
					<!-- Section Syst√®me Vocal -->
					<section class="admin-section" id="voice-section">
						<div class="voice-cards">
							<div class="voice-card">
								<div class="card-header">
									<h3>Reconnaissance Vocale (STT)</h3>
									<span class="status-indicator" id="stt-indicator">
									<span class="status-dot"></span>
									<span class="status-text">Chargement...</span>
									</span>
								</div>
								<div class="card-content">
									<div class="info-item">
										<span class="label">Moteur :</span>
										<span class="value" id="stt-engine">Whisper.cpp</span>
									</div>
									<div class="info-item">
										<span class="label">Mod√®le :</span>
										<span class="value" id="stt-model">-</span>
									</div>
									<div class="info-item">
										<span class="label">Chemin :</span>
										<span class="value path" id="stt-path">-</span>
									</div>
								</div>
								<div class="card-actions">
									<button class="btn secondary" id="test-stt-btn">
									<i class="fas fa-microphone"></i> Tester la reconnaissance
									</button>
								</div>
							</div>
							<div class="voice-card">
								<div class="card-header">
									<h3>Synth√®se Vocale (TTS)</h3>
									<span class="status-indicator" id="tts-indicator">
									<span class="status-dot"></span>
									<span class="status-text">Chargement...</span>
									</span>
								</div>
								<div class="card-content">
									<div class="info-item">
										<span class="label">Moteur :</span>
										<span class="value" id="tts-engine">Piper</span>
									</div>
									<div class="info-item">
										<span class="label">Voix :</span>
										<span class="value" id="tts-voice">-</span>
									</div>
									<div class="info-item">
										<span class="label">√âchantillonnage :</span>
										<span class="value" id="tts-sample-rate">-</span>
									</div>
								</div>
								<div class="card-actions">
									<div class="form-inline">
										<input id="tts-test-text" placeholder="Texte √† synth√©tiser..." type="text" value="Ceci est un test de synth√®se vocale."/>
										<button class="btn secondary" id="test-tts-btn">
										<i class="fas fa-play"></i> Tester
										</button>
									</div>
								</div>
							</div>
						</div>
						<div class="section-header">
							<h3>Voix disponibles</h3>
						</div>
						<div class="voices-list" id="voices-list">
							<!-- Liste des voix g√©n√©r√©e dynamiquement -->
							<div class="voice-item">
								<div class="voice-name">fr_FR-siwis-medium</div>
								<div class="voice-info">Fran√ßais (Siwis)</div>
								<div class="voice-actions">
									<button class="btn mini test-voice-btn">
									<i class="fas fa-play"></i>
									</button>
								</div>
							</div>
							<div class="voice-item">
								<div class="voice-name">en_US-amy-medium</div>
								<div class="voice-info">Anglais (Amy)</div>
								<div class="voice-actions">
									<button class="btn mini test-voice-btn">
									<i class="fas fa-play"></i>
									</button>
								</div>
							</div>
						</div>
					</section>
					<!-- Section Configuration -->
					<section class="admin-section" id="config-section">
						<div class="config-tabs">
							<div class="tab-header">
								<div class="tab active" data-tab="general">G√©n√©ral</div>
								<div class="tab" data-tab="models">Mod√®les</div>
								<div class="tab" data-tab="voice">Vocal</div>
								<div class="tab" data-tab="memory">M√©moire</div>
							</div>
							<div class="tab-content">
								<div class="tab-pane active" id="general-config">
									<div class="config-item">
										<label for="data-dir">R√©pertoire de donn√©es :</label>
										<input id="data-dir" readonly="" type="text"/>
									</div>
									<div class="config-item">
										<label for="debug-mode">Mode debug :</label>
										<div class="toggle-switch">
											<input id="debug-mode" type="checkbox"/>
											<span class="toggle-slider"></span>
										</div>
									</div>
								</div>
								<div class="tab-pane" id="models-config">
									<div class="config-form" id="models-config-form">
										<div class="loading-indicator">
											<i class="fas fa-spinner fa-spin"></i> Chargement de la configuration...
										</div>
									</div>
								</div>
								<div class="tab-pane" id="voice-config">
									<div class="config-item">
										<label for="stt-model-path">Mod√®le STT :</label>
										<input id="stt-model-path" type="text"/>
									</div>
									<div class="config-item">
										<label for="tts-model-name">Mod√®le TTS :</label>
										<select id="tts-model-name">
											<option value="fr_FR-siwis-medium">Fran√ßais (Siwis)</option>
											<option value="en_US-amy-medium">Anglais (Amy)</option>
										</select>
									</div>
									<div class="config-item">
										<label for="tts-sample-rate-input">Taux d'√©chantillonnage :</label>
										<input id="tts-sample-rate-input" max="48000" min="8000" step="1000" type="number"/>
									</div>
								</div>
								<div class="tab-pane" id="memory-config">
									<div class="config-item">
										<label for="vector-dimension">Dimension des vecteurs :</label>
										<input id="vector-dimension" max="4096" min="768" step="128" type="number"/>
									</div>
									<div class="config-item">
										<label for="max-history">Taille max. de l'historique :</label>
										<input id="max-history" max="100" min="5" type="number"/>
									</div>
									<div class="config-item">
										<label for="memory-refresh">Intervalle de compression (conversations) :</label>
										<input id="memory-refresh" max="50" min="1" type="number"/>
									</div>
									<div class="config-section">
										<h4>M√©moire Symbolique</h4>
										<div class="config-item">
											<label for="use-chatgpt-symbolic">Utiliser ChatGPT pour l'extraction d'entit√©s et relations :</label>
											<div class="toggle-switch">
												<input id="use-chatgpt-symbolic" type="checkbox"/>
												<span class="toggle-slider"></span>
											</div>
										</div>
										<div class="config-note" id="chatgpt-api-note" style="display:none;">
											<p><i class="fas fa-info-circle"></i> Cl√© API OpenAI non configur√©e. D√©finissez la variable d'environnement OPENAI_API_KEY pour activer cette fonctionnalit√©.</p>
										</div>
										<div class="config-item">
											<p class="help-text">Lorsque cette option est activ√©e, le syst√®me utilise l'API ChatGPT pour extraire des entit√©s et relations plus pr√©cises pour le graphe symbolique. Lorsqu'elle est d√©sactiv√©e, le syst√®me utilise l'extracteur local.</p>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="config-actions">
							<button class="btn primary" id="save-config-btn">
							<i class="fas fa-save"></i> Enregistrer
							</button>
							<button class="btn secondary" id="reset-config-btn">
							<i class="fas fa-undo"></i> R√©initialiser
							</button>
						</div>
					</section>
					<!-- Section Logs -->
					<section class="admin-section" id="logs-section">
						<div class="logs-filters">
							<div class="form-group">
								<label for="log-level">Niveau :</label>
								<select id="log-level">
									<option value="DEBUG">DEBUG</option>
									<option selected="" value="INFO">INFO</option>
									<option value="WARNING">WARNING</option>
									<option value="ERROR">ERROR</option>
								</select>
							</div>
							<div class="form-group">
								<label for="log-component">Composant :</label>
								<select id="log-component">
									<option value="">Tous</option>
									<option value="models">Mod√®les</option>
									<option value="memory">M√©moire</option>
									<option value="voice">Vocal</option>
									<option value="api">API</option>
								</select>
							</div>
							<div class="form-group">
								<label for="log-limit">Limite :</label>
								<select id="log-limit">
									<option value="50">50 entr√©es</option>
									<option selected="" value="100">100 entr√©es</option>
									<option value="250">250 entr√©es</option>
									<option value="500">500 entr√©es</option>
								</select>
							</div>
							<button class="btn secondary" id="refresh-logs-btn">
							<i class="fas fa-sync-alt"></i> Actualiser
							</button>
						</div>
						<div class="logs-container">
							<div class="logs-header">
								<div class="log-time">Horodatage</div>
								<div class="log-level">Niveau</div>
								<div class="log-component">Composant</div>
								<div class="log-message">Message</div>
							</div>
							<div class="logs-content" id="logs-content">
								<div class="loading-indicator">
									<i class="fas fa-spinner fa-spin"></i> Chargement des logs...
								</div>
							</div>
						</div>
					</section>
					<!-- Section Lumi√®res -->
					<section class="admin-section" id="lights-section">
						<div class="section-header with-actions">
							<h3>Lumi√®res et contr√¥les domotiques</h3>
							<div class="header-actions">
								<button class="btn secondary" id="refresh-lights-btn">
								<i class="fas fa-sync-alt"></i> Actualiser
								</button>
								<select class="form-control" id="filter-room">
									<option value="all">Toutes les pi√®ces</option>
									<!-- Les options seront ajout√©es dynamiquement -->
								</select>
							</div>
						</div>
						<div class="rooms-container" id="rooms-container">
							<!-- Les groupes/pi√®ces seront charg√©s ici dynamiquement -->
						</div>
						<div class="lights-container" id="lights-container">
							<!-- Les lumi√®res seront charg√©es ici dynamiquement -->
							<div class="loading-indicator">
								<i class="fas fa-spinner fa-spin"></i> Chargement des lumi√®res...
							</div>
						</div>
						<div class="empty-state" id="no-lights-message" style="display: none;">
							<p>Aucune lumi√®re d√©tect√©e.</p>
							<p>Si vous avez des lumi√®res Philips Hue, assurez-vous que le Bridge est correctement configur√©.</p>
							<p>Vous pouvez √©galement utiliser des lumi√®res simul√©es pour tester.</p>
						</div>
					</section>
				</div>
			</main>
		</div>
		<!-- Modals -->
		<div class="modal" id="confirm-modal">
			<div class="modal-content">
				<div class="modal-header">
					<h3>Confirmation</h3>
					<button class="close-modal-btn">√ó</button>
				</div>
				<div class="modal-body">
					<p id="confirm-message">√ätes-vous s√ªr de vouloir effectuer cette action ?</p>
				</div>
				<div class="modal-footer">
					<button class="btn primary" id="confirm-yes-btn">Confirmer</button>
					<button class="btn secondary" id="confirm-no-btn">Annuler</button>
				</div>
			</div>
		</div>
		<div class="modal" id="memory-viewer-modal">
			<div class="modal-content large">
				<div class="modal-header">
					<h3>Visualisation de la m√©moire</h3>
					<button class="close-modal-btn">√ó</button>
				</div>
				<div class="modal-body">
					<div class="memory-viewer-tabs">
						<div class="tab-header">
							<div class="tab active" data-tab="vector">Vectorielle</div>
							<div class="tab" data-tab="synthetic">Synth√©tique</div>
							<div class="tab" data-tab="symbolic">Symbolique</div>
						</div>
						<div class="tab-content">
							<div class="tab-pane active" id="vector-memory-view">
								<div class="memory-search">
									<input id="vector-search" placeholder="Rechercher dans la m√©moire vectorielle..." type="text"/>
									<button class="btn secondary" id="vector-search-btn">
									<i class="fas fa-search"></i> Rechercher
									</button>
								</div>
								<div class="memory-results" id="vector-memory-results">
									<p class="empty-state">Utilisez la recherche pour explorer la m√©moire vectorielle</p>
								</div>
							</div>
							<div class="tab-pane" id="synthetic-memory-view">
								<div class="topic-selector">
									<label for="topic-select">Sujet :</label>
									<select id="topic-select">
										<option value="">Chargement...</option>
									</select>
								</div>
								<div class="memory-results" id="synthetic-memory-results">
									<p class="empty-state">S√©lectionnez un sujet pour voir les m√©moires</p>
								</div>
							</div>
							<div class="tab-pane" id="symbolic-memory-view">
								<div class="graph-container" id="graph-container">
									<!-- Le graphe sera rendu ici -->
									<div class="empty-state">
										<p>Visualisation du graphe de connaissance</p>
										<button class="btn secondary" id="load-graph-btn">
										<i class="fas fa-project-diagram"></i> Charger le graphe</button>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="modal" id="scenes-modal">
			<div class="modal-content">
				<div class="modal-header">
					<h3>Appliquer une sc√®ne</h3>
					<button class="close-modal-btn">√ó</button>
				</div>
				<div class="modal-body">
					<div class="scene-selection">
						<div class="scene-option" data-scene="relax">
							<div class="scene-preview" style="background-color: rgb(255, 200, 120);"></div>
							<div class="scene-name">D√©tente</div>
						</div>
						<div class="scene-option" data-scene="concentrate">
							<div class="scene-preview" style="background-color: rgb(230, 230, 255);"></div>
							<div class="scene-name">Concentration</div>
						</div>
						<div class="scene-option" data-scene="energize">
							<div class="scene-preview" style="background-color: rgb(255, 255, 255);"></div>
							<div class="scene-name">Dynamique</div>
						</div>
						<div class="scene-option" data-scene="reading">
							<div class="scene-preview" style="background-color: rgb(255, 230, 200);"></div>
							<div class="scene-name">Lecture</div>
						</div>
					</div>
					<input id="scene-target-id" type="hidden"/>
					<input id="scene-target-type" type="hidden"/>
				</div>
				<div class="modal-footer">
					<button class="btn primary" id="apply-scene-btn">Appliquer</button>
					<button class="btn secondary close-modal-btn">Annuler</button>
				</div>
			</div>
		</div>
		<!-- Scripts JavaScript -->
		<script src="scripts/config.js"></script>
		<script src="scripts/admin.js"></script>
		<script src="scripts/admin-light.js"></script>
		<script src="scripts/graph-visualization.js"></script>
		<script src="scripts/symbolic-graph-ui.js"></script>
		<script src="scripts/graph-entrypoint.js"></script>
		<script src="scripts/monitoring.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
		<script src="scripts/symbolic-rules-editor.js"></script>
        <script src="scripts/memory-ui.js"></script>
	</body>
</html>